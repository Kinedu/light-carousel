'use strict';var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{!d&&h['return']&&h['return']()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError('Invalid attempt to destructure non-iterable instance')}}(),_createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_extends=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},_react=require('react'),_react2=_interopRequireDefault(_react),_propTypes=require('prop-types'),_propTypes2=_interopRequireDefault(_propTypes),_ramda=require('ramda'),R=_interopRequireWildcard(_ramda);Object.defineProperty(exports,'__esModule',{value:!0});function _interopRequireWildcard(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b.default=a,b}function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function _inherits(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function _objectWithoutProperties(a,b){var c={};for(var d in a)0<=b.indexOf(d)||Object.prototype.hasOwnProperty.call(a,d)&&(c[d]=a[d]);return c}var equalAt=function(c,a,b){return R.eqBy(R.view(R.lensPath(b)),c,a)},LightCarouselContainer=function(a){var b=a.children,c=a.containerStyle,d=_objectWithoutProperties(a,['children','containerStyle']);return _react2.default.createElement('div',{style:_extends({position:'relative',display:'block',width:'100%'},c)},b)},Slideshow=function(a){var b=a.children,c=a.className,d=a.slideshowStyle,e=a.slideshowRef,f=_objectWithoutProperties(a,['children','className','slideshowStyle','slideshowRef']);return _react2.default.createElement('div',_extends({},f,{ref:e,style:_extends({position:'relative',display:'block',width:'100%',overflowX:'hidden'},d)}),b)},SlidesContainer=function(a){var b=a.children,c=a.slideshowWidth,d=a.slideContainerRef,e=_objectWithoutProperties(a,['children','slideshowWidth','slideContainerRef']);return _react2.default.createElement('div',_extends({},e,{ref:d,style:{position:'relative',transform:'translate3d(0, 0, 0)',width:c}}),b)},Slide=function(a){var b=a.children,c=a.autoWidth,d=a.slideWidth,e=a.gap,f=_objectWithoutProperties(a,['children','autoWidth','slideWidth','gap']);return _react2.default.createElement('div',_extends({},f,{style:{position:'relative',display:'block',float:'left',width:c,marginRight:e}}),b)},ButtonsContainer=function(a){var b=a.children,c=a.buttonsContainerStyle,d=_objectWithoutProperties(a,['children','buttonsContainerStyle']);return _react2.default.createElement('div',_extends({},d,{style:_extends({position:'relative'},c)}),b)},Button=function(a){var b=a.children,c=_objectWithoutProperties(a,['children']);return _react2.default.createElement('span',_extends({},c,{style:{cursor:'pointer'}}),b)},LightCarousel=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));return c.initCarousel=function(){var a=c.props,b=a.autoplay,d=a.gap,e=a.infinite,f=a.slideWidth,g=a.slidesToShow,h=a.setSlide,i=a.stopOnHover,j=a.speed,k=a.responsive,l=a.children;c.breakpoints=Object.keys(k),c.slidesToShow=g,c.setResizeBreakpoint(),k&&c.currentBreakpoint&&(c.slidesToShow=k[c.currentBreakpoint]),c.slideshowClientWidth=R.path(['clientWidth'],c.slideshow),c.autoWidth=(c.slideshowClientWidth+d)/c.slidesToShow-d,c.displacement=(f||c.autoWidth)+d,c.currentPosition=e?-(c.displacement*c.slidesToShow):0,c.totalUniqueElements=_react2.default.Children.toArray(l).length,c.totalSlides=e?c.calculateTotalSlides(c.slidesToShow,c.totalUniqueElements):c.totalUniqueElements,c.slideshowWidth=c.totalSlides*(c.displacement+d),c.autoplayFunc=b&&setInterval(c.moveForward,j),e&&i&&b&&c.setMouseEvents(c.clearAutoplay,c.setAutoplay),c.setResizeEvent(),c.slidesContainer.style.transform='translateX('+c.currentPosition+'px)',0<h&&c.slideTo(h)},c.onSlide=function(){c.props.infinite&&(c.state.currentSlide===c.totalUniqueElements?(console.log('start'),c.resetPositionTo('start')):-1===c.state.currentSlide&&(console.log('end'),c.resetPositionTo('end')),c.resetCurrentSlide()),c.setState({enableClick:!0})},c.setEndTransition=function(a){var b=document.createElement('element'),d=Object.entries({transition:'transitionend',OTransition:'oTransitionEnd',MozTransition:'transitionend',WebkitTransition:'webkitTransitionEnd'}).find(function(a){var c=_slicedToArray(a,1),d=c[0];return void 0!==b.style[d]})[1];c.setState({endTransition:d},function(){return c.slidesContainer.addEventListener(c.state.endTransition,a,!1)})},c.setMouseEvents=function(a,b){c.slidesContainer.addEventListener('mouseover',a,!1),c.slidesContainer.addEventListener('mouseout',b,!1)},c.setResizeEvent=function(){window.addEventListener('resize',c.handleResize)},c.setAutoplay=function(){c.autoplayFunc=setInterval(c.moveForward,c.props.speed)},c.setResizeBreakpoint=function(){if(c.breakpoints){var a=window.innerWidth;c.currentBreakpoint=0,c.breakpoints.forEach(function(b){a>=b&&(c.currentBreakpoint=b)})}},c.handleResize=function(){c.setResizeBreakpoint(),c.resetSliderPosition()},c.resetSliderPosition=function(){c.slideTo(0),c.currentPosition=0,c.slidesContainer.style.transform='translateX('+c.currentPosition+'px)'},c.clearAutoplay=function(){clearInterval(c.autoplayFunc)},c.calculateTotalSlides=function(a,b){return 2*a+b},c.addClones=function(a,b){for(var c=0;c<b;c+=1)a.push(a[c]);for(var d=0;d<b;d+=1)a.unshift(a[a.length-d-(b+1)]);return a},c.moveBackward=function(){c.state.enableClick&&(0<c.state.currentSlide||c.props.infinite)&&(c.slideTo('prev'),c.move('left'),c.setState({enableClick:!1}))},c.moveForward=function(){c.state.enableClick&&(!c.isLastSlide()||c.props.infinite)&&(c.slideTo('next'),c.move(),c.setState({enableClick:!1}))},c.isLastSlide=function(){var a=c.state.currentSlide>=c.totalUniqueElements-c.slidesToShow;return a},c.slideTo=function(a){var b=c.state.currentSlide;'next'===a?b+=1:'prev'===a?b-=1:b=a,c.setState({currentSlide:b,enableClick:!0},function(){'prev'===a&&c.props.onPreviousSlide(c.state.currentSlide),'next'===a&&c.props.onNextSlide(c.state.currentSlide)})},c.move=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:'right';c.movingTo=a;var b=c.displacement;!isNaN(a)&&0<a&&(b*=a),'left'===a&&(b*=-1),c.currentPosition-=b,c.slidesContainer.style.transition='transform 0.4s ease-in',c.slidesContainer.style.transform='translateX('+c.currentPosition+'px)'},c.resetPositionTo=function(a){var b=0;'start'===a?b=-(c.displacement*c.slidesToShow):'end'==a&&(b=-(c.displacement*(c.totalUniqueElements+c.slidesToShow-1))),c.currentPosition=b,c.slidesContainer.style.transition='transform 0s ease-in',c.slidesContainer.style.transform='translateX('+c.currentPosition+'px)'},c.resetCurrentSlide=function(){var a=0;0>c.state.currentSlide?a=c.totalUniqueElements-1:c.state.currentSlide<c.totalUniqueElements&&(a=c.state.currentSlide),c.setState({currentSlide:a})},c.hasAllItemsVisible=function(){return 0===c.state.currentSlide&&c.isLastSlide()},c.renderSlides=function(a){var b=c.props,d=b.slidesToShow,e=b.slideWidth,f=b.gap,g=b.infinite,h=b.responsive;c.slidesToShow=d,c.setResizeBreakpoint(),h&&c.currentBreakpoint&&(c.slidesToShow=h[c.currentBreakpoint]);var i=_react2.default.Children.toArray(a),j=R.path(['clientWidth'],c.slideshow)||0,k=0<=j?j:c.slideshowClientWidth,l=(k+f)/c.slidesToShow-f;return c.displacement=(e||l)+f,c.slideshowWidth=c.displacement*(c.totalSlides||1),g&&c.addClones(i,c.slidesToShow),_react2.default.createElement(SlidesContainer,{className:'light-carousel-slides-container',slideContainerRef:function slideContainerRef(a){c.slidesContainer=a},slideshowWidth:c.slideshowWidth},i.map(function(a,b){return _react2.default.createElement(Slide,{key:b,className:'light-carousel-slide',autoWidth:l,slideWidth:e,gap:f},a)}))},c.state={currentSlide:0,enableClick:!0},c}return _inherits(b,a),_createClass(b,[{key:'componentDidMount',value:function componentDidMount(){this.initCarousel(),this.setEndTransition(this.onSlide)}},{key:'componentWillReceiveProps',value:function componentWillReceiveProps(a){equalAt(this.props,a,['setSlide'])||(this.slideTo(a.setSlide),this.move(a.setSlide))}},{key:'componentWillUnmount',value:function componentWillUnmount(){this.slidesContainer.removeEventListener(this.state.endTransition,this.onSlide,!1),this.slidesContainer.removeEventListener('mouseover',this.clearAutoplay,!1),this.slidesContainer.removeEventListener('mouseout',this.setAutoplay,!1),window.removeEventListener('resize',this.handleResize,!1),this.clearAutoplay()}},{key:'render',value:function render(){var a=this,b=this.props,c=b.prevBtn,d=b.nextBtn,e=b.showControls,f=b.slideshowStyle,g=b.containerStyle,h=b.buttonsContainerStyle,i=b.infinite,j=b.className,k=b.children;return _react2.default.createElement(LightCarouselContainer,{className:'light-carousel '+j,containerStyle:g},_react2.default.createElement(Slideshow,{className:'light-carousel-slideshow',slideshowStyle:f,slideshowRef:function slideshowRef(b){a.slideshow=b}},this.renderSlides(k)),e&&!this.hasAllItemsVisible()&&_react2.default.createElement(ButtonsContainer,{className:'light-carousel-buttons-container',buttonsContainerStyle:h},_react2.default.createElement(Button,{className:'light-carousel-button move-prev '+(0!==this.state.currentSlide||i?'':'disabled'),onClick:function onClick(){return a.moveBackward()}},c),_react2.default.createElement(Button,{className:'light-carousel-button move-next '+(this.isLastSlide()&&!i?'disabled':''),onClick:function onClick(){return a.moveForward()}},d)))}}]),b}(_react.Component);LightCarousel.propTypes={children:_propTypes2.default.node,slidesToShow:_propTypes2.default.number,setSlide:_propTypes2.default.number,slideWidth:_propTypes2.default.number,gap:_propTypes2.default.number,autoplay:_propTypes2.default.bool,speed:_propTypes2.default.number,stopOnHover:_propTypes2.default.bool,infinite:_propTypes2.default.bool,showControls:_propTypes2.default.bool,prevBtn:_propTypes2.default.node,nextBtn:_propTypes2.default.node,onPreviousSlide:_propTypes2.default.func,onNextSlide:_propTypes2.default.func,responsive:_propTypes2.default.object,className:_propTypes2.default.string,slideshowStyle:_propTypes2.default.oneOfType([_propTypes2.default.object,_propTypes2.default.array,_propTypes2.default.string]),containerStyle:_propTypes2.default.oneOfType([_propTypes2.default.object,_propTypes2.default.array,_propTypes2.default.string]),buttonsContainerStyle:_propTypes2.default.oneOfType([_propTypes2.default.object,_propTypes2.default.array,_propTypes2.default.string])},LightCarousel.defaultProps={children:[],slidesToShow:1,setSlide:0,slideWidth:null,gap:0,autoplay:!1,speed:3e3,stopOnHover:!0,infinite:!1,showControls:!1,prevBtn:'prev',nextBtn:'next',onPreviousSlide:function onPreviousSlide(){},onNextSlide:function onNextSlide(){},className:'',responsive:{},slideshowStyle:{},containerStyle:{},buttonsContainerStyle:[]},exports.default=LightCarousel;